@{
  ViewData["Title"] = "Smart Meter Data";
  Layout = "_Layout";
}


<div class="container-fluid">
  <div class="col-xl-8 col-lg-7">
    <div class="card shadow mb-4">
      <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">Area Chart</h6>
      </div>
      <div class="card-body">
        <div class="chart-area">
          <canvas id="smartMeterChart"></canvas>
        </div>
      </div>
    </div>
    </div>

  </div>
  <script>
    fetch('/smartmeterdata-no-solar-pannels')
      .then(res => res.json())
      .then(data => {
        const labels = data.map(item => item.Items_Timestamp_UTC);
        const values = data.map(item => item.Items_ConsumptionDeliveryTotal);

        new Chart(document.getElementById('smartMeterChart'), {
          type: 'line',
          data: {
            labels: labels,
            datasets: [{
              label: 'Smart Meter Consumption (kWh)',
              data: values,
              borderColor: 'rgba(54, 162, 235, 0.8)',
              backgroundColor: 'rgba(54, 162, 235, 0.2)',
              borderWidth: 2,
              fill: true,
              tension: 0.4,
              pointRadius: 0
            }]
          },
          options: {
            responsive: true,
            layout: {
              padding: 20
            },
            scales: {
              x: {
                type: 'time',
                time: {
                  parser: 'YYYY-MM-DD HH:mm:ssZ',
                  tooltipFormat: 'MMM D, HH:mm',
                  unit: 'day',
                  displayFormats: {
                    day: 'MMM D'
                  }
                },
                ticks: {
                  autoSkip: true,
                  maxTicksLimit: 7,
                  font: {
                    size: 10
                  },
                  maxRotation: 0,
                  minRotation: 0
                },
                title: {
                  display: true,
                  text: 'Date'
                }
              },
              y: {
                beginAtZero: true,
                title: {
                  display: true,
                  text: 'Consumption (kWh)'
                }
              }
            },
            plugins: {
              tooltip: {
                mode: 'index',
                intersect: false,
                callbacks: {
                  label: function(context) {
                    return ` ${context.dataset.label}: ${context.raw} kWh`;
                  }
                }
              },
              legend: {
                display: true,
                position: 'top'
              }
            }
          }
        });
      });



  </script>
